(this["webpackJsonpfuse-react-app"]=this["webpackJsonpfuse-react-app"]||[]).push([[10],{1088:function(e,t,a){"use strict";a.r(t);var n=a(21),r=a(44),c=a(0),l=a.n(c),o=a(1067),s=a.n(o),i=a(187),m=a.n(i),u=a(263),p=a(962),d=a(953),f=a(943),b=a(13),v=a(9),h=a(983),g=a(95),E=a.n(g),j=a(183),x=a(55),y=a.n(x);function O(e){var t=Object(v.b)(),a=Object(c.useState)(!1),r=Object(n.a)(a,2),o=r[0],s=r[1],i=function(){var a=Object(u.a)(m.a.mark((function a(n){return m.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,s(!0),a.next=4,y.a.post("".concat("http://www.polepath.com/api","/users/changestagename"),{stageName:n.stageName});case 4:200===a.sent.status&&(t(b.J(n.stageName)),s(!1),e.close()),a.next=11;break;case 8:a.prev=8,a.t0=a.catch(0),409===a.t0.response.status&&t(b.F({message:a.t0.response.data.message,autoHideDuration:6e3,anchorOrigin:{vertical:"top",horizontal:"right"},variant:"error"}));case 11:case"end":return a.stop()}}),a,null,[[0,8]])})));return function(e){return a.apply(this,arguments)}}();return l.a.createElement(c.Fragment,null,l.a.createElement(f.a,{className:"flex flex-col align-center",open:e.open,onClose:e.close,"aria-labelledby":"form-dialog-title"},l.a.createElement(h.a,{id:"form-dialog-title"},"Change your stage name"),l.a.createElement(E.a,{onValidSubmit:i,className:"px-16 pb-16 flex flex-col justify-center w-full items-center"},l.a.createElement(j.c,{className:"my-16",type:"text",name:"stageName",label:"Your new stagename",multiline:!0,validations:{minLength:4},validationErrors:{minLength:"Min character length is 4"},variant:"outlined",required:!0,value:""}),l.a.createElement(d.a,{className:"flex justify-end"},l.a.createElement(p.a,{onClick:e.close,variant:"contained",color:"secondary"},"Cancel"),l.a.createElement(p.a,{type:"submit",variant:"contained",color:"secondary",disabled:o},"Submit")))))}var w=a(188),N=a(162),C=a(970),k=a(944),S=a(181),H=a(942),I=a(940),M=a(1065),L=a.n(M),Y=(a(1066),a(991)),W=a(16),D=Object(k.a)((function(e){var t;return{cropContainer:{width:"100%",height:"400px",padding:0,display:"flex",justifyContent:"center",alignItems:"center",overflow:"hidden"},dialogPaper:(t={margin:0,display:"flex",flexDirection:"column",alignItems:"center",padding:"10 auto",minHeight:"85vh",maxHeight:"85vh",minWidth:"82vw",maxWidth:"85vw",justifyContent:"space-evenly"},Object(r.a)(t,e.breakpoints.up("sm"),{minWidth:"70vw",maxWidth:"70vw"}),Object(r.a)(t,e.breakpoints.up("md"),{minWidth:"55vw",maxWidth:"55vw"}),Object(r.a)(t,e.breakpoints.up("lg"),{minWidth:"30vw"}),t)}})),R=function(e){var t=Object(v.b)(),a=D(),r=Object(c.useState)(null),o=Object(n.a)(r,2),s=o[0],i=o[1],g=Object(c.useState)(!1),E=Object(n.a)(g,2),j=E[0],x=E[1],O=Object(c.useRef)(null);Object(c.useEffect)((function(){if(j)var e=new L.a(O.current,{viewMode:2,zoomable:!1,scalable:!1,aspectRatio:1,highlight:!1,background:!1,center:!1,guides:!1,crop:function(){e.getCroppedCanvas().toBlob((function(e){i(e)}))}})}),[e.src,j]),Object(c.useEffect)((function(){x(!0)}),[]);var w=function(){var a=Object(u.a)(m.a.mark((function a(){var n,r;return m.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return(n=new FormData).append("image",s),i(null),a.prev=3,a.next=6,y.a.post("".concat("http://www.polepath.com/api","/users/changeavatar"),n);case 6:200===(r=a.sent).status&&(t(Object(b.H)(r.data.photoURL)),e.close()),a.next=13;break;case 10:a.prev=10,a.t0=a.catch(3),t(W.D({message:a.t0.response.data.message,variant:"error"}));case 13:case"end":return a.stop()}}),a,null,[[3,10]])})));return function(){return a.apply(this,arguments)}}();return l.a.createElement(f.a,{open:e.open,onClose:e.close},l.a.createElement(d.a,{className:a.dialogPaper},l.a.createElement(h.a,{className:"text-center"},"Crop your photo"),l.a.createElement(d.a,{className:a.cropContainer},l.a.createElement("img",{src:e.src,ref:O,alt:"Crop Area",className:"max-h-full max-w-full block"})),l.a.createElement(Y.a,{className:"flex justify-end"},l.a.createElement(p.a,{color:"primary",disabled:!s,type:"button",onClick:w},"Save"),l.a.createElement(p.a,{color:"primary",type:"button",onClick:e.close},"Cancel"))))},z=a(182),U=a(3),B=Object(k.a)((function(e){return{counter:{color:e.palette.primary.main}}}));var F=l.a.memo((function(e){var t=B();return l.a.createElement(z.a,{className:"w-full rounded-8 shadow-none border-1 mx-8"},l.a.createElement("div",{className:"text-center pt-6 pb-6"},l.a.createElement(S.a,{className:Object(U.default)(t.counter,"text-72 leading-none ")},e.count)),l.a.createElement("div",{className:"flex items-center px-16 h-52 border-t-1"},l.a.createElement(S.a,{className:"text-15 flex w-full",color:"textSecondary"},l.a.createElement("span",{className:"truncate"},e.label))))})),P=a(947),A=a(959),J=a(265),T=a.n(J),_=a(90),q=Object(k.a)((function(e){return{activityContainer:{padding:0,margin:0,minHeight:"400px",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"}}})),G=function(e){var t=q(e),a=Object(_.g)(),r=Object(c.useState)(null),o=Object(n.a)(r,2),s=o[0],i=o[1],m=Object(c.useState)(!1),u=Object(n.a)(m,2),p=u[0],f=u[1],b=Object(c.useState)(!0),v=Object(n.a)(b,2),h=v[0],g=v[1];Object(c.useEffect)((function(){var e=y.a.CancelToken.source();return y.a.get("".concat("http://www.polepath.com/api","/users/history"),{cancelToken:e.token}).then((function(e){var t=e.data.activity.reverse();i(t),g(!1)})).catch((function(e){f(!0)})),function(){e.cancel("Component got unmounted")}}),[]);var E=l.a.createElement(S.a,{variant:"h6",className:"mb-16"},"Couldn't load latest activity :(");return l.a.createElement("div",{className:"flex flex-col justify-center items-center mx-8 mt-20 border-1 p-0 rounded-8 "},l.a.createElement(S.a,{variant:"h6",className:"mb-16"},"Latest Activity"),l.a.createElement(d.a,{className:t.activityContainer},h?l.a.createElement(P.a,null):p?E:s.map((function(e,t){var n;switch(e.event){case"photo":n="You added a new  ".concat(e.polemoveId.name," ").concat(e.event,".");break;case"mastered":n="Congratulations! You mastered the ".concat(e.polemoveId.name," move.");break;case"started":n="You started to learn the ".concat(e.polemoveId.name," move. Good luck!");break;default:return!0}return l.a.createElement("div",{key:e._id,className:"flex justify-center mb-8 w-full flex-col border-0 bg-gray-100 cursor-pointer",onClick:function(){return function(e){var t="/moves/polemoves/".concat(e);a.push(t)}(e.polemoveId._id)}},l.a.createElement(S.a,{className:"mb-16 pl-16",variant:"subtitle1"},n)," ",l.a.createElement(S.a,{variant:"caption",display:"block",gutterBottom:!0,className:"text-right pr-8"},T()(e.createdAt).format("dddd, MMMM Do YYYY, h:mm:ss a")),t!==s.length-1&&l.a.createElement(A.a,{light:!0}))}))))},V=Object(k.a)((function(e){return{layoutHeader:Object(r.a)({height:320,minHeight:320},e.breakpoints.down("md"),{height:240,minHeight:240}),avatar:{cursor:"pointer"}}}));t.default=function(e){var t=V(),a=Object(c.useState)(!1),r=Object(n.a)(a,2),o=r[0],i=r[1],m=Object(c.useState)(null),u=Object(n.a)(m,2),p=u[0],d=u[1],f=Object(c.useState)(0),b=Object(n.a)(f,2),h=b[0],g=b[1],E=Object(c.useState)(null),j=Object(n.a)(E,2),x=j[0],y=j[1],k=Object(v.c)((function(e){return e.auth.user})),M=Object(v.c)((function(e){return e.moves.progress}));return Object(c.useEffect)((function(){if(M){var e=M.data.filter((function(e){return!0===e.mastered}));g(e.length)}}),[M]),l.a.createElement(N.a,{classes:{header:t.layoutHeader,toolbar:"px-16 sm:px-24"},header:l.a.createElement(c.Fragment,null,l.a.createElement("div",{className:"p-24 flex flex-1 flex-col items-center justify-center md:flex-row md:items-end"},l.a.createElement("div",{className:"flex flex-1 flex-col items-center justify-center md:flex-row md:items-center md:justify-start"},l.a.createElement(w.a,{animation:"transition.expandIn",delay:300},l.a.createElement(C.a,{className:"mb-16 w-96 h-96 ".concat(t.avatar),src:k.photoURL,onClick:function(e){d(e.currentTarget)}})),l.a.createElement(w.a,{animation:"transition.slideLeftIn",delay:300},l.a.createElement(S.a,{className:"md:mx-24",variant:"h4",color:"inherit"},k.stageName,l.a.createElement(s.a,{className:"ml-8 cursor-pointer",fontSize:"small",onClick:function(){return i(!0)}})))),p&&l.a.createElement(I.a,{open:Boolean(p),anchorEl:p,onClose:function(){return d(null)},anchorOrigin:{vertical:"top",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"left"}},l.a.createElement(H.a,{role:"button",component:"label"},"Update Profile Picture"," ",l.a.createElement("input",{type:"file",onChange:function(e){e.target.files&&y(URL.createObjectURL(e.target.files[0]))},style:{display:"none"}}))))),content:l.a.createElement("div",{className:"p-16 sm:p-24"},l.a.createElement(O,{action:"confirm",open:o,close:function(){return i(!1)}}),l.a.createElement("div",{className:"flex justify-between "},l.a.createElement(F,{count:h,label:"Moves Mastered"}),l.a.createElement(F,{count:M.data.length,label:"Moves Started"})),l.a.createElement(G,null)," ",x&&l.a.createElement(R,{open:Boolean(x),src:x,close:function(){return y(null)}}))})}}}]);