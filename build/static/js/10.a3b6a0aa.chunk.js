(this["webpackJsonpfuse-react-app"]=this["webpackJsonpfuse-react-app"]||[]).push([[10],{1082:function(e,t,a){"use strict";a.r(t);var n=a(21),r=a(44),c=a(0),l=a.n(c),o=a(1068),i=a.n(o),s=a(186),m=a.n(s),u=a(263),d=a(962),p=a(953),f=a(943),b=a(13),h=a(9),v=a(990),g=a(95),x=a.n(g),E=a(187),j=a(55),y=a.n(j);function w(e){var t=Object(h.b)(),a=Object(c.useState)(!1),r=Object(n.a)(a,2),o=r[0],i=r[1],s=function(){var a=Object(u.a)(m.a.mark((function a(n){return m.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,i(!0),a.next=4,y.a.post("".concat("http://www.polepath.com/api","/users/changestagename"),{stageName:n.stageName});case 4:200===a.sent.status&&(t(b.J(n.stageName)),i(!1),e.close()),a.next=11;break;case 8:a.prev=8,a.t0=a.catch(0),409===a.t0.response.status&&t(b.F({message:a.t0.response.data.message,autoHideDuration:6e3,anchorOrigin:{vertical:"top",horizontal:"right"},variant:"error"}));case 11:case"end":return a.stop()}}),a,null,[[0,8]])})));return function(e){return a.apply(this,arguments)}}();return l.a.createElement(c.Fragment,null,l.a.createElement(f.a,{className:"flex flex-col align-center",open:e.open,onClose:e.close,"aria-labelledby":"form-dialog-title"},l.a.createElement(v.a,{id:"form-dialog-title"},"Change your stage name"),l.a.createElement(x.a,{onValidSubmit:s,className:"px-16 pb-16 flex flex-col justify-center w-full items-center"},l.a.createElement(E.c,{className:"my-16",type:"text",name:"stageName",label:"Your new stagename",multiline:!0,validations:{minLength:4},validationErrors:{minLength:"Min character length is 4"},variant:"outlined",required:!0,value:""}),l.a.createElement(p.a,{className:"flex justify-end"},l.a.createElement(d.a,{onClick:e.close,variant:"contained",color:"secondary"},"Cancel"),l.a.createElement(d.a,{type:"submit",variant:"contained",color:"secondary",disabled:o},"Submit")))))}var O=a(56),N=a(206),C=a(162),k=a(970),S=a(944),I=a(181),M=a(182),H=a(3),F=Object(S.a)((function(e){return{counter:{color:e.palette.primary.main}}}));var L=l.a.memo((function(e){var t=F();return l.a.createElement(M.a,{className:"w-full rounded-8 shadow-none border-1 mx-8"},l.a.createElement("div",{className:"text-center pt-6 pb-6"},l.a.createElement(I.a,{className:Object(H.default)(t.counter,"text-72 leading-none ")},e.count)),l.a.createElement("div",{className:"flex items-center px-16 h-52 border-t-1"},l.a.createElement(I.a,{className:"text-15 flex w-full",color:"textSecondary"},l.a.createElement("span",{className:"truncate"},e.label))))})),Y=a(947),U=a(959),W=a(265),D=a.n(W),R=a(90),z=Object(S.a)((function(e){return{activityContainer:{padding:0,margin:0,minHeight:"400px",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"}}})),P=function(e){var t=z(e),a=Object(R.g)(),r=Object(c.useState)(null),o=Object(n.a)(r,2),i=o[0],s=o[1],m=Object(c.useState)(!1),u=Object(n.a)(m,2),d=u[0],f=u[1],b=Object(c.useState)(!0),h=Object(n.a)(b,2),v=h[0],g=h[1];Object(c.useEffect)((function(){var e=y.a.CancelToken.source();return y.a.get("".concat("http://www.polepath.com/api","/users/history"),{cancelToken:e.token}).then((function(e){s(e.data.activity),g(!1)})).catch((function(e){f(!0)})),function(){e.cancel("Component got unmounted")}}),[]);var x=l.a.createElement(I.a,{variant:"h6",className:"mb-16"},"Couldn't load latest activity :(");return l.a.createElement("div",{className:"flex flex-col justify-center items-center mx-8 mt-20 border-1 p-0 rounded-8 "},l.a.createElement(I.a,{variant:"h6",className:"mb-16"},"Latest Activity"),l.a.createElement(p.a,{className:t.activityContainer},v?l.a.createElement(Y.a,null):d?x:i.map((function(e,t){var n;switch(e.event){case"photo":n="You added a new  ".concat(e.polemoveId.name," ").concat(e.event,".");break;case"mastered":n="Congratulations! You mastered the ".concat(e.polemoveId.name," move.");break;case"started":n="You started to learn the ".concat(e.polemoveId.name," move. Good luck!");break;default:return!0}return l.a.createElement("div",{key:e._id,className:"flex justify-center mb-8 w-full flex-col border-0 bg-gray-100 cursor-pointer",onClick:function(){return function(e){var t="/moves/polemoves/".concat(e);a.push(t)}(e.polemoveId)}},l.a.createElement(I.a,{className:"mb-16 pl-16",variant:"subtitle1"},n)," ",l.a.createElement(I.a,{variant:"caption",display:"block",gutterBottom:!0,className:"text-right pr-8"},D()(e.createdAt).format("dddd, MMMM Do YYYY, h:mm:ss a")),t!==i.length-1&&l.a.createElement(U.a,{light:!0}))}))))},T=a(989),A=a(890),B=a(901),J=a(1066),q=a.n(J),G=(a(1067),a(16)),V=Object(S.a)((function(e){return{cropContainer:{width:"100%",height:"400px",padding:0,display:"flex",justifyContent:"center",alignItems:"center",overflow:"hidden"}}})),_=function(e){var t=Object(h.b)(),a=V(),r=Object(c.useState)(null),o=Object(n.a)(r,2),i=o[0],s=o[1],f=Object(c.useRef)(null);Object(c.useEffect)((function(){if(f.current)var e=new q.a(f.current,{viewMode:2,zoomable:!1,scalable:!1,aspectRatio:1,highlight:!1,background:!1,center:!1,guides:!1,crop:function(){e.getCroppedCanvas().toBlob((function(e){s(e)}))}})}),[e.src]);var g=function(){var a=Object(u.a)(m.a.mark((function a(){var n,r;return m.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return(n=new FormData).append("image",i),s(null),a.prev=3,a.next=6,y.a.post("".concat("http://www.polepath.com/api","/users/changeavatar"),n);case 6:200===(r=a.sent).status&&(t(Object(b.H)(r.data.photoURL)),e.close()),a.next=13;break;case 10:a.prev=10,a.t0=a.catch(3),t(G.D({message:a.t0.response.data.message,variant:"error"}));case 13:case"end":return a.stop()}}),a,null,[[3,10]])})));return function(){return a.apply(this,arguments)}}();return l.a.createElement(c.Fragment,null,l.a.createElement(v.a,{className:"text-center"},"Crop your photo"),l.a.createElement(p.a,{className:a.cropContainer},l.a.createElement("img",{src:e.src,ref:f,alt:"Crop Area",className:"max-h-full max-w-full block"})),l.a.createElement(T.a,{className:"flex justify-end"},l.a.createElement(d.a,{color:"primary",disabled:!i,type:"button",onClick:g},"Save"),l.a.createElement(d.a,{color:"primary",type:"button",onClick:e.close},"Cancel")))},K=Object(S.a)((function(e){var t;return{dialogPaper:(t={margin:0,display:"flex",flexDirection:"column",alignItems:"center",padding:"10 auto",minHeight:"85vh",maxHeight:"85vh",minWidth:"82vw",maxWidth:"85vw",justifyContent:"space-evenly"},Object(r.a)(t,e.breakpoints.up("sm"),{minWidth:"70vw",maxWidth:"70vw"}),Object(r.a)(t,e.breakpoints.up("md"),{minWidth:"55vw",maxWidth:"55vw"}),Object(r.a)(t,e.breakpoints.up("lg"),{minWidth:"30vw"}),t),placeholder:{width:"100%",height:"320px",padding:0,display:"flex",justifyContent:"center",alignItems:"center"},button:{color:e.palette.primary}}})),Q=function(e){var t=K(),a=Object(c.useState)(""),r=Object(n.a)(a,2),o=r[0],i=r[1],s=Object(c.useState)(!1),m=Object(n.a)(s,2),u=m[0],b=m[1],h=function(){i(""),b(!1),e.close()};return l.a.createElement(f.a,{open:e.open,onClose:h},l.a.createElement(p.a,{className:t.dialogPaper},u?l.a.createElement(_,{src:o,close:h}):l.a.createElement(c.Fragment,null,l.a.createElement(v.a,{className:"text-center"},"Update profile picture"),l.a.createElement(U.a,{color:"primary",className:"mb-10 w-full",variant:"middle"}),l.a.createElement(B.a,{className:"w-full text-left",htmlFor:"photoUpload"},"Choose your photo:"),l.a.createElement(A.a,{id:"photoUpload",className:"mb-20 w-full",type:"file",variant:"outlined",onChange:function(e){e.target.files&&i(URL.createObjectURL(e.target.files[0]))}}),l.a.createElement(U.a,{color:"primary",className:"mb-10 w-full",variant:"middle"}),l.a.createElement(p.a,{className:Object(H.default)(t.placeholder,!o&&"border-dashed border-2 border-gray-200")},o?l.a.createElement("img",{src:o,alt:"Preview",className:"max-h-full max-w-full block"}):l.a.createElement("div",null,"Preview"))," ",l.a.createElement(T.a,{className:"flex justify-end"},l.a.createElement(d.a,{color:"primary",disabled:!o,type:"button",onClick:function(){return b(!0)}},"Next"),l.a.createElement(d.a,{color:"primary",type:"button",onClick:h},"Cancel")))))},X=Object(S.a)((function(e){return{layoutHeader:Object(r.a)({height:320,minHeight:320},e.breakpoints.down("md"),{height:240,minHeight:240}),avatar:{cursor:"pointer"},input:{width:"95%",marginTop:"1em",paddingBottom:"1em"},alert:{width:"100%",position:"absolute",zIndex:10,top:0,left:0,color:"rgb(30, 70, 32)",backgroundColor:"rgb(237, 247, 237)"},snackbar:{zIndex:15},card:{marginTop:"30px"}}}));t.default=Object(h.a)(null,(function(e){return Object(O.c)({showMessage:b.F,hideMessage:b.o},e)}))((function(e){var t=X(),a=Object(c.useState)(!1),r=Object(n.a)(a,2),o=r[0],s=r[1],m=Object(c.useState)(!1),u=Object(n.a)(m,2),d=u[0],p=u[1],f=Object(c.useState)(0),b=Object(n.a)(f,2),v=b[0],g=b[1],x=Object(h.c)((function(e){return e.auth.user})),E=Object(h.c)((function(e){return e.moves.progress}));return Object(c.useEffect)((function(){if(E){var e=E.data.filter((function(e){return!0===e.mastered}));g(e.length)}}),[E]),l.a.createElement(C.a,{classes:{header:t.layoutHeader,toolbar:"px-16 sm:px-24"},header:l.a.createElement(c.Fragment,null,l.a.createElement("div",{className:"p-24 flex flex-1 flex-col items-center justify-center md:flex-row md:items-end"},l.a.createElement("div",{className:"flex flex-1 flex-col items-center justify-center md:flex-row md:items-center md:justify-start"},l.a.createElement(N.a,{animation:"transition.expandIn",delay:300},l.a.createElement(k.a,{className:"mb-16 w-96 h-96 ".concat(t.avatar),src:x.photoURL,onClick:function(){p(!0)}})),l.a.createElement(N.a,{animation:"transition.slideLeftIn",delay:300},l.a.createElement(I.a,{className:"md:mx-24",variant:"h4",color:"inherit"},x.stageName,l.a.createElement(i.a,{className:"ml-8 cursor-pointer",fontSize:"small",onClick:function(){return s(!0)}})))))),content:l.a.createElement("div",{className:"p-16 sm:p-24"},l.a.createElement(Q,{action:"confirm",open:d,close:function(){return p(!1)},user:x}),l.a.createElement(w,{action:"confirm",open:o,close:function(){return s(!1)}}),l.a.createElement("div",{className:"flex justify-between "},l.a.createElement(L,{count:v,label:"Moves Mastered"}),l.a.createElement(L,{count:E.data.length,label:"Moves Started"})),l.a.createElement(P,null)," ")})}))}}]);